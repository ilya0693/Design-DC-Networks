# Проектирование адресного пространства

## Цель
1. Собрать схему CLOS;
2. Распределить адресное пространство.

## Описание/Пошаговая инструкция выполнения домашнего задания:
В этой самостоятельной работе мы ожидаем, что вы самостоятельно:
1. Соберете топологию CLOS, как на схеме:

![alt-текст](https://github.com/ilya0693/Design-DC-Networks/blob/main/Homework1/%D0%A2%D0%BE%D0%BF%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D1%8F%20CLOS.avif "Топология CLOS")

2. Распределите адресное пространство для Underlay сети.
3. План работы, адресное пространство, схема сети, настройки - зафиксированы в документации. Документация оформлена на github (markdown).

## Выполнение домашнего задания
### Топология сети ЦОД и ее описание
Схема сети центра обработки данных (далее ЦОД) компании ООО "Оринтекс" города Краснодар представлена ниже. 

![alt-текст](https://github.com/ilya0693/Design-DC-Networks/blob/main/Homework1/%D0%A1%D1%85%D0%B5%D0%BC%D0%B0%20%D1%81%D0%B5%D1%82%D0%B8%20%D0%A6%D0%9E%D0%94%20(%D0%94%D0%971)-L1-L2%20%D1%82%D0%BE%D0%BF%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D1%8F.png "Схема сети ЦОД")

На схеме видно, что сеть ЦОДа представляет собой сеть, включающую в себя 3 Leaf и 2 Spine коммутатора. Каждый Leaf подключается к каждому Spine в сети по L3 соединению (соединению p2p). Клиенты подключаются к Leaf коммутаторам. Интерфейсы со стороны Leaf коммутаторов переведены в режим Access и назначены в соответствующие VLAN'ы. На рисунке ниже представлена L3 схема (схема межвзаимодействия) между сетевыми устройствами.

![alt-текст](https://github.com/ilya0693/Design-DC-Networks/blob/main/Homework1/v%201.0%20%D0%A1%D1%85%D0%B5%D0%BC%D0%B0%20%D1%81%D0%B5%D1%82%D0%B8%20%D0%A6%D0%9E%D0%94%20(%D0%94%D0%971)-L3%20%D1%81%D1%85%D0%B5%D0%BC%D0%B0.png "Схема межвзаимодействия между сетевыми устройствами")

### Адресное пространство для Underlay
#### Краткая информация о резервировании IP-адресов

Для нашего ЦОДа выделена сеть `10.123.0.0/16` которая, в свою очередь, разбивается на подсети. Такая сеть выбрана из следующих соображений:
1. Первый октет означает класс сети и остается неизменным. Так как сеть класса "А" имеет большой диапазон IP-адресов, для возможности масштабирования и сегментации была выбрана сеть данного класса `(10.0.0.0/8)`. 
2. Второй октет обозначает номер региона, в котором находится ЦОД. В нашем примере ЦОД расположен в Краснодарском крае - 123 регион.
3. Значение третьего октета варьируется в зависимости от роли/назначения подсети. Если подсеть предназначена для пользователей или сервисов, то значение 3го октета варьируется от 100 до 255. Данные значения сопоставляются с номером VLAN'а в сети ЦОД. Например, если сервисы заведены в VLAN 100, то они будут в подсети 10.123.100.0/24. Если подсеть предназначена для сетевых устройств (например, для p2p соединений или Loopback интерфейсов), то значение 3го октета варьируется от 0 до 99.
4. Четвертый октет может быть любым числом от 1 до 254.

Ниже представлено резервирование подсетей и таблица IP-адресации, назначенные на устройства.

##### Таблица 1 - Таблица резервирования подсетей

|Локация           |Сеть           |Подсеть       |VLAN ID|Название VLAN|Описание VLAN'а / подсети                                                                   |
|-------------     |---------------|--------------|-------|-------------|--------------------------------------------------------------------------------------------|
|ЦОД ООО "Оринтекс"|10.123.0.0/24  |N/A           |N/A    |N/A          |Зарезервированная подсеть для Loopback интерфейсов Spine и Leaf коммутаторов                |
|                  |10.123.1.0/24  |N/A           |N/A    |N/A          |Зарезервированная подсеть для p2p соединения между сетевыми устройствами                    |
|                  |10.123.1.0/24  |10.123.1.0/31 |N/A    |N/A          |Зарезервированная подсеть для p2p соединения между Leaf-1 <--> Spine-1                      |
|                  |10.123.1.0/24  |10.123.1.2/31 |N/A    |N/A          |Зарезервированная подсеть для p2p соединения между Leaf-1 <--> Spine-2                      |
|                  |10.123.1.0/24  |10.123.1.4/31 |N/A    |N/A          |Зарезервированная подсеть для p2p соединения между Leaf-2 <--> Spine-1                      |
|                  |10.123.1.0/24  |10.123.1.6/31 |N/A    |N/A          |Зарезервированная подсеть для p2p соединения между Leaf-2 <--> Spine-2                      |
|                  |10.123.1.0/24  |10.123.1.8/31 |N/A    |N/A          |Зарезервированная подсеть для p2p соединения между Leaf-3 <--> Spine-1                      |
|                  |10.123.1.0/24  |10.123.1.10/31|N/A    |N/A          |Зарезервированная подсеть для p2p соединения между Leaf-3 <--> Spine-2                      |
|                  |10.123.100.0/24|N/A           |100    |Clients      |Подсеть клиентов                                                                            |


##### Таблица 2 - Таблица адресации
|Device |Port  |IP-address      |VLAN|Default GW     |Comment                                                |
|-------|------|----------------|----|---------------|-------------------------------------------------------|
|Client1|eth0  |10.123.100.10/24|100 |10.123.100.1/24|Client VLAN                                            |
|Client2|eth0  |10.123.100.11/24|100 |10.123.100.1/24|Client VLAN                                            |
|Client3|eth0  |10.123.100.12/24|100 |10.123.100.1/24|Client VLAN                                            |
|Client4|eth0  |10.123.100.13/24|100 |10.123.100.1/24|Client VLAN                                            |
|Leaf-1 |SVI100|10.123.100.1/24 |100 |N/A            |default gateway for Clients devices                    |
|Leaf-1 |eth1  |10.123.1.1/31   |N/A |N/A            |p2p connect with Spine-1: eth1                         |
|Leaf-1 |eth2  |10.123.1.3/31   |N/A |N/A            |p2p connect with Spine-2: eth1                         |
|Leaf-1 |Lo0   |10.123.0.11/32  |N/A |N/A            |Router ID for dynamic routing protocols (Underlay)     |
|Leaf-1 |Lo1   |10.123.0.12/32  |N/A |N/A            |VTEP address for VxLAN (Overlay)                       |
|Leaf-2 |SVI100|10.123.100.1/24 |100 |N/A            |default gateway for Clients devices                    |
|Leaf-2 |eth1  |10.123.1.5/31   |N/A |N/A            |p2p connect with Spine-1: eth2                         |
|Leaf-2 |eth2  |10.123.1.7/31   |N/A |N/A            |p2p connect with Spine-2: eth2                         |
|Leaf-2 |Lo0   |10.123.0.21/32  |N/A |N/A            |Router ID for dynamic routing protocols (Underlay)     |
|Leaf-2 |Lo1   |10.123.0.22/32  |N/A |N/A            |VTEP address for VxLAN (Overlay)                       |
|Leaf-3 |SVI100|10.123.100.1/24 |100 |N/A            |default gateway for Clients devices                    |
|Leaf-3 |eth1  |10.123.1.9/31   |N/A |N/A            |p2p connect with Spine-1: eth3                         |
|Leaf-3 |eth2  |10.123.1.11/31  |N/A |N/A            |p2p connect with Spine-2: eth3                         |
|Leaf-3 |Lo0   |10.123.0.31/32  |N/A |N/A            |Router ID for dynamic routing protocols (Underlay)     |
|Leaf-3 |Lo1   |10.123.0.32/32  |N/A |N/A            |VTEP address for VxLAN (Overlay)                       |
|Spine-1|eth1  |10.123.1.0/31   |N/A |N/A            |p2p connect with Leaf-1: eth1                          |
|Spine-1|eth2  |10.123.1.4/31   |N/A |N/A            |p2p connect with Leaf-2: eth1                          |
|Spine-1|eth3  |10.123.1.8/31   |N/A |N/A            |p2p connect with Leaf-3: eth1                          |
|Spine-1|Lo0   |10.123.0.41/32  |N/A |N/A            |Router ID for dynamic routing protocols (Underlay)     |
|Spine-2|eth1  |10.123.1.2/31   |N/A |N/A            |p2p connect with Leaf-1: eth2                          |
|Spine-2|eth2  |10.123.1.6/31   |N/A |N/A            |p2p connect with Leaf-2: eth2                          |
|Spine-2|eth3  |10.123.1.21/31  |N/A |N/A            |p2p connect with Leaf-3: eth2                          |
|Spine-2|Lo0   |10.123.0.51/31  |N/A |N/A            |Router ID for dynamic routing protocols (Underlay)     |


#### Информация о резервировании Loopback адресов
В таблице 1 видно, что для Loopback адресов зарезервирована подсеть `10.123.0.0/24`. IP-адреса Loopback назначаются с использованием /32 маски, то есть, в случае зарезервированной подсети у нас нет разбиения на подсети, а из диапазона адресов выбирается любой свободный IP-адрес. Чтобы систематизировать процесс назначения IP-адресов Loopback, рекомендуется назначать IP-адреса по одному из нижеперечисленных способов:

1. `10.123.0.XY/32`
2. `10.123.0.XYZ/32` 

Рассмотрим 1 способ. В случае 1го способа используются значения `_XY_`,
где `_X_` - зарезервированное значение **(от 1 до 9)** для сетевого устройства. Для коммутатора Leaf-1 зарезервировано число "1", для Leaf-2 - "2", Leaf-3 - "3", Spine-1 - "4", Spine-2 - "5", значения "6-9" зарезервированы для сетевых устройств;
`_Y_` - значение **от 0 до 9**, которое назначается на сетевое устройство. Выбирается любое свободное значение.

Например, в случае с коммутатором Leaf-1, в качестве Loopback адреса назначается IP-адрес `10.123.0.11/32`. Если необходимо назначить еще один Loopback адрес на Leaf-1 (например, для построения VxLAN), то назначается IP-адрес `10.123.0.12/32`. Если значений `_Y_` не хватает, то применяется 2 способ.

В случае 2го способа используются значения `_XYZ_`,
где `_X_` - резервное значение **от 1 до 2**, которое используется в случае нехватки IP-адресов по 1 способу.
`_Y_` - зарезервированное значение для сетевого устройства. Для коммутатора Leaf-1 зарезервировано число "1", для Leaf-2 - "2", Leaf-3 - "3", Spine-1 - "4", Spine-2 - "5", значения "6-9" зарезервированы для сетевых устройств. 

**_Примечание_**: Следует отметить, что значение `_Y_` зависимо от `_X_`, то есть, если `_X_=1`, то значение `_Y_` варьируется **от 0 до 9**, если `_X_=2` - **от 0 до 5**.

`_Z_` - значение, которое назначается на сетевое устройство. Выбирается любое свободное значение.

**_Примечание_**: Значение `_Z_` зависимо от значения `_X_` и, в некоторых случаях, зависимо от значения `_Y_`. Если `_X_=1`, то значение `_Z_` варьируется **от 0 до 9** и не зависит от значения `_Y_`. Если `_X_=2`, то `_Z_` варьируется от **от 0 до 9**, если значение `_Y_= от 0 до 4`. Если `_X_=2`, а `_Y_=5` то `_Z_` варьируется от **от 0 до 5**.

Например, в случае с коммутатором Leaf-1, в качестве Loopback адреса назначается IP-адрес `10.123.0.111/32`. Если необходимо назначить еще один Loopback адрес на Leaf-1, то назначается IP-адрес `10.123.0.112/32`. 
Второй способ рекомендуется применять только в случае нехватки Loopback адресов при использовании 1 способа.

### Конфигурация сетевого оборудования
Конфигурацию оборудования смотрите в **_Homework2_**
